=====================================================================
AJPscripts - xdg.referrer to Descript.ion

Линда Кайе 2016-2025. Посвящается Ариэль
=====================================================================

Этот скрипт берёт содержимое файлов из NTFS потока user.xdg.referrer.url и сохраняет его как описание соответствующих файлов в Descript.ion. Это может быть полезно, например, для сохранения оригинальных ссылок к видео, скаченному утилитой youtude-dl. Возможна обработка всех файлов в каталоге или только некоторых.

Для обработки всех файлов в текущем каталоге, достаточно запустить скрипт вот так:

> CScript.EXE //NoLogo XdgReferrerToDescription.WSF

При этом сгенерированные описания будут дописаны в файл Descript.ion. Если там что-то уже было, скрипт допишет новые данные, отделив их пустой строкой, а старые оставит на усмотрение пользователя. Тоесть в файле описаний могут возникнуть дубли. Так задумано на случай, если описание каких-то файлов поправлены самим пользователем, и затирать их не следует.

Для обработки только двух определённых файлов:

> CScript.EXE //NoLogo XdgReferrerToDescription.WSF video.mpg hentai.mkv

Программа не запрещает указывать в этом случае путь к файлам (скажем, если они лежат в подкаталоге), но делать этого не следует, так как формат файла Descript.ion не предполагает путей к файлам.

Файл Descript.ion сохраняется в кодировке UTF-8. Для сохранения в системной OEM кодировке, следует указать ключ вот так:

> CScript.EXE //NoLogo XdgReferrerToDescription.WSF /OEM

Так же для поддержки утилиты youtube-dl в программе есть возможность сохранять описания для картинок с тем же именем, что и файл. Так, если у файла hentai.mkv есть описание, то оно сохранится как для самого hentai.mkv, так и для предпросмотра hentai.jpg, если таковой существует. Для того чтобы это работало, нужно сделать вот так:

> CScript.EXE //NoLogo XdgReferrerToDescription.WSF /JPG

Описания приписываются ко всем картинкам с тем же именем, какие будут найдены (не только с расширением JPG).

История изменений
-----------------

• 30.09.2018
  Первый публичный релиз.
  
• 27.03.2019
  [+] Убрала ReadMe из заголовка скрипта. Чтобы не было дублей.
  [+] Теперь ищутся картинки с расширениями BMP, RLE, JPG, JPEG, GIF и PNG.
  
• 25.02.2023
  [+] Добавлено расширение предпросмотров WebP.
  
• 13.05.2025
  [-] Функция GetCharset() в модуле CharToOem.VBS была капитально поломана и возвращала только значения по умолчанию.

Маленький копирайт
------------------

1. Программа и исходный код распространяются бесплатно.
2. Вы имеете право распространять их на тех же условиях.
3. Вы не имеете права использовать имя автора после модификации исходного кода.
4. При этом желательно указывать ссылку на автора оригинальной версии исходного кода.
5. Вы не имеете права на платное распространение исходного кода, а также программных модулей, содержащих данный исходнй код.
6. Программа и исходный код распространяются как есть. Автор не несёт ответственности за любые трагедии или несчастные случаи, вызванные использованием программы и исходного кода.
7. Для любого пункта данного соглашения может быть сделано исключение с разрешения автора программы.
8. По любым вопросам, связанным с данной программой, обращайтесь по адресу lindaoneesama@gmail.com

Загружено с https://www.lindachan.net